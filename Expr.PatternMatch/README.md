Pattern Matching (parse) direction:

Expr -> ShapeSymbol

PEG parser(Parsing Expression Grammar)
https://github.com/otac0n/Pegasus

Pattern Matcher does not tackle relation issue.